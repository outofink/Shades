var y=Object.defineProperty;var _=(a,e,t)=>e in a?y(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var n=(a,e,t)=>(_(a,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const S="modulepreload",p=function(a){return"/shades/"+a},g={},w=function(e,t,o){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(r=>{if(r=p(r),r in g)return;g[r]=!0;const i=r.endsWith(".css"),h=i?'[rel="stylesheet"]':"";if(!!o)for(let d=s.length-1;d>=0;d--){const u=s[d];if(u.href===r&&(!i||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${h}`))return;const l=document.createElement("link");if(l.rel=i?"stylesheet":S,i||(l.as="script",l.crossOrigin=""),l.href=r,document.head.appendChild(l),i)return new Promise((d,u)=>{l.addEventListener("load",d),l.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e())};function C(a={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:o,onRegistered:s,onRegisteredSW:r,onRegisterError:i}=a;let h,m;const l=async(u=!0)=>{await m};async function d(){if("serviceWorker"in navigator){const{Workbox:u}=await w(()=>import("./workbox-window.prod.es5-295a6886.js"),[]);h=new u("/shades/sw.js",{scope:"/shades/",type:"classic"}),h.addEventListener("activated",c=>{!c.isUpdate&&c.isExternal||c.isUpdate?window.location.reload():o==null||o()}),h.register({immediate:e}).then(c=>{r?r("/shades/sw.js",c):s==null||s(c)}).catch(c=>{i==null||i(c)})}}return m=d(),l}class L{constructor(){n(this,"_best");this._best=parseInt(localStorage.getItem("best")||"0")}get best(){return this._best}set best(e){this._best=e,localStorage.setItem("best",this._best.toString())}}class E{constructor(){n(this,"root");n(this,"score");n(this,"best");n(this,"board");this.root=document.documentElement,this.score=document.getElementById("score"),this.best=document.getElementById("best-score"),this.board=document.getElementById("grid")}updateScore(e){this.score.onanimationend=()=>{this.score.classList.remove("animate"),this.root.style.setProperty("--old",`"${e}"`)},this.root.style.setProperty("--new",`"${e}"`),this.score.classList.add("animate")}updateBest(e){this.best.onanimationend=()=>{this.best.classList.remove("best-animate"),this.root.style.setProperty("--old-best",`"${e}"`)},this.root.style.setProperty("--new-best",`"${e}"`),this.best.classList.add("best-animate")}renderBoard(e){this.clear(),this.root.style.setProperty("--x",e.x.toString()),this.root.style.setProperty("--y",e.y.toString()),this.root.style.setProperty("--color",e.color.toCSS()),this.root.style.setProperty("--different",e.otherColor.toCSS());for(let t=0;t<e.numberOfSquares;t++){const o=document.createElement("div");o.classList.add("box"),t===e.chosen&&o.classList.add("different"),this.board.appendChild(o)}}getHandlerType(){return/iPad|iPhone|iPod/.test(navigator.userAgent)?"touchstart":"click"}clear(){var e;for(;(e=this.board)!=null&&e.firstChild;)this.board.removeChild(this.board.lastChild)}}const v=50,B=.97;class f{constructor(e,t,o){n(this,"l");n(this,"a");n(this,"b");this.l=e,this.a=t,this.b=o}toCSS(){let e=this.LabToXYZ(this),t=this.XYZToRGB(e);return`rgb(${t.r},${t.g},${t.b})`}LabToXYZ(e){let t=.008856451679035631,o=24389/27,s=(e.l+16)/116,r=e.a/500+s,i=s-e.b/200,h=r**3>t?r**3:(116*r-16)/o,m=e.l>o*t?Math.pow((e.l+16)/116,3):e.l/o,l=i**3>t?i**3:(116*i-16)/o;return{x:h*.95047,y:m,z:l*1.08883}}XYZToRGB(e){let t=e.x*1.7552599+e.y*-.4836786+e.z*-.253,o=e.x*-.5441336+e.y*1.5068789+e.z*.0215528,s=e.x*.0063467+e.y*-.0175761+e.z*1.2256959,r=[t,o,s];return r.forEach((i,h)=>{i>.0031308?i=1.055*Math.pow(i,1/2.4)-.055:i*=12.92,r[h]=Math.floor(i*255)}),{r:r[0],g:r[1],b:r[2]}}}class b{constructor(e){n(this,"color");n(this,"otherColor");[this.color,this.otherColor]=this.genColors(e)}genColors(e){const t=Math.ceil(v*Math.pow(B,e));let o=new f(Math.floor(Math.random()*25)+50,Math.floor(Math.random()*100)-50,Math.floor(Math.random()*100)-50),s=this.getOtherColor(o,t);return[o,s]}getOtherColor(e,t){let o=Math.random()<.5?-t:t;return Math.random()<.5?new f(e.l,e.a+o,e.b):new f(e.l,e.a,e.b+o)}}class O{constructor(){n(this,"_colors");n(this,"_numberOfSquares");n(this,"_chosen");n(this,"_dimensions");this._colors=new b(0),this._numberOfSquares=this.getNumberOfSquares(0),this._chosen=this.getChosen(this.numberOfSquares),this._dimensions=this.getBoardDimensions(this.numberOfSquares)}getBoardDimensions(e){let t=e,o=1;for(const s of[2,3,4])e%s===0&&e/s!==1&&(t=e/s,o=s);return[t,o]=[t,o].sort(),{x:t,y:o}}getChosen(e){return Math.floor(Math.random()*e)}getNumberOfSquares(e){if(e>=14)return 20;let t=e+3;for(;[7,11,13,14,17,18,19].includes(t);)t+=1;return t}generateBoard(e){this._colors=new b(e),this._numberOfSquares=this.getNumberOfSquares(e),this._chosen=this.getChosen(this.numberOfSquares),this._dimensions=this.getBoardDimensions(this.numberOfSquares)}get color(){return this._colors.color}get otherColor(){return this._colors.otherColor}get chosen(){return this._chosen}get numberOfSquares(){return this._numberOfSquares}get x(){return this._dimensions.x}get y(){return this._dimensions.y}}class P{constructor(){n(this,"_score");n(this,"_best");n(this,"gameView");n(this,"localStore");n(this,"board");this.localStore=new L,this._score=0,this._best=this.localStore.best,this.gameView=new E,this.board=new O}start(){this.gameView.updateScore(this.score),this.gameView.updateBest(this.best),this.gameView.renderBoard(this.board),this.addEventListeners()}addEventListeners(){var t;((t=document.getElementById("grid"))==null?void 0:t.childNodes).forEach(o=>o.addEventListener(this.gameView.getHandlerType(),s=>{s.preventDefault(),s.target.classList[1]?(this.score+=1,this.score>this.best&&(this.best+=1)):this.score=0},!1))}get best(){return this._best}set best(e){this._best=e,this.localStore.best=e,this.gameView.updateBest(this.best)}get score(){return this._score}set score(e){this._score=e,this.board.generateBoard(this.score),this.gameView.updateScore(this.score),this.gameView.renderBoard(this.board),this.addEventListeners()}}C();const q=new P;q.start();
