var B=Object.defineProperty;var M=(r,t,e)=>t in r?B(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var f=(r,t,e)=>(M(r,typeof t!="symbol"?t+"":t,e),e);const k=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(s){if(s.ep)return;s.ep=!0;const c=e(s);fetch(s.href,c)}};k();try{self["workbox:window:6.5.2"]&&_()}catch{}function L(r,t){return new Promise(function(e){var n=new MessageChannel;n.port1.onmessage=function(s){e(s.data)},r.postMessage(t,[n.port2])})}function x(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function P(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function I(r,t){var e;if(typeof Symbol>"u"||r[Symbol.iterator]==null){if(Array.isArray(r)||(e=function(s,c){if(s){if(typeof s=="string")return P(s,c);var a=Object.prototype.toString.call(s).slice(8,-1);return a==="Object"&&s.constructor&&(a=s.constructor.name),a==="Map"||a==="Set"?Array.from(s):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?P(s,c):void 0}}(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return(e=r[Symbol.iterator]()).next.bind(e)}try{self["workbox:core:6.5.2"]&&_()}catch{}var w=function(){var r=this;this.promise=new Promise(function(t,e){r.resolve=t,r.reject=e})};function S(r,t){var e=location.href;return new URL(r,e).href===new URL(t,e).href}var v=function(r,t){this.type=r,Object.assign(this,t)};function p(r,t,e){return e?t?t(r):r:(r&&r.then||(r=Promise.resolve(r)),t?r.then(t):r)}function W(){}var R={type:"SKIP_WAITING"};function O(r,t){if(!t)return r&&r.then?r.then(W):Promise.resolve()}var T=function(r){var t,e;function n(d,h){var o,i;return h===void 0&&(h={}),(o=r.call(this)||this).nn={},o.tn=0,o.rn=new w,o.en=new w,o.on=new w,o.un=0,o.an=new Set,o.cn=function(){var u=o.fn,l=u.installing;o.tn>0||!S(l.scriptURL,o.sn.toString())||performance.now()>o.un+6e4?(o.vn=l,u.removeEventListener("updatefound",o.cn)):(o.hn=l,o.an.add(l),o.rn.resolve(l)),++o.tn,l.addEventListener("statechange",o.ln)},o.ln=function(u){var l=o.fn,g=u.target,m=g.state,y=g===o.vn,b={sw:g,isExternal:y,originalEvent:u};!y&&o.mn&&(b.isUpdate=!0),o.dispatchEvent(new v(m,b)),m==="installed"?o.wn=self.setTimeout(function(){m==="installed"&&l.waiting===g&&o.dispatchEvent(new v("waiting",b))},200):m==="activating"&&(clearTimeout(o.wn),y||o.en.resolve(g))},o.dn=function(u){var l=o.hn,g=l!==navigator.serviceWorker.controller;o.dispatchEvent(new v("controlling",{isExternal:g,originalEvent:u,sw:l,isUpdate:o.mn})),g||o.on.resolve(l)},o.gn=(i=function(u){var l=u.data,g=u.ports,m=u.source;return p(o.getSW(),function(){o.an.has(m)&&o.dispatchEvent(new v("message",{data:l,originalEvent:u,ports:g,sw:m}))})},function(){for(var u=[],l=0;l<arguments.length;l++)u[l]=arguments[l];try{return Promise.resolve(i.apply(this,u))}catch(g){return Promise.reject(g)}}),o.sn=d,o.nn=h,navigator.serviceWorker.addEventListener("message",o.gn),o}e=r,(t=n).prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e;var s,c,a=n.prototype;return a.register=function(d){var h=(d===void 0?{}:d).immediate,o=h!==void 0&&h;try{var i=this;return function(u,l){var g=u();return g&&g.then?g.then(l):l(g)}(function(){if(!o&&document.readyState!=="complete")return O(new Promise(function(u){return window.addEventListener("load",u)}))},function(){return i.mn=Boolean(navigator.serviceWorker.controller),i.yn=i.pn(),p(i.bn(),function(u){i.fn=u,i.yn&&(i.hn=i.yn,i.en.resolve(i.yn),i.on.resolve(i.yn),i.yn.addEventListener("statechange",i.ln,{once:!0}));var l=i.fn.waiting;return l&&S(l.scriptURL,i.sn.toString())&&(i.hn=l,Promise.resolve().then(function(){i.dispatchEvent(new v("waiting",{sw:l,wasWaitingBeforeRegister:!0}))}).then(function(){})),i.hn&&(i.rn.resolve(i.hn),i.an.add(i.hn)),i.fn.addEventListener("updatefound",i.cn),navigator.serviceWorker.addEventListener("controllerchange",i.dn),i.fn})})}catch(u){return Promise.reject(u)}},a.update=function(){try{return this.fn?O(this.fn.update()):void 0}catch(d){return Promise.reject(d)}},a.getSW=function(){return this.hn!==void 0?Promise.resolve(this.hn):this.rn.promise},a.messageSW=function(d){try{return p(this.getSW(),function(h){return L(h,d)})}catch(h){return Promise.reject(h)}},a.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&L(this.fn.waiting,R)},a.pn=function(){var d=navigator.serviceWorker.controller;return d&&S(d.scriptURL,this.sn.toString())?d:void 0},a.bn=function(){try{var d=this;return function(h,o){try{var i=h()}catch(u){return o(u)}return i&&i.then?i.then(void 0,o):i}(function(){return p(navigator.serviceWorker.register(d.sn,d.nn),function(h){return d.un=performance.now(),h})},function(h){throw h})}catch(h){return Promise.reject(h)}},s=n,(c=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&x(s.prototype,c),n}(function(){function r(){this.Pn=new Map}var t=r.prototype;return t.addEventListener=function(e,n){this.Sn(e).add(n)},t.removeEventListener=function(e,n){this.Sn(e).delete(n)},t.dispatchEvent=function(e){e.target=this;for(var n,s=I(this.Sn(e.type));!(n=s()).done;)(0,n.value)(e)},t.Sn=function(e){return this.Pn.has(e)||this.Pn.set(e,new Set),this.Pn.get(e)},r}());function j(r={}){const{immediate:t=!1,onNeedRefresh:e,onOfflineReady:n,onRegistered:s,onRegisterError:c}=r;let a;const d=async(h=!0)=>{};return"serviceWorker"in navigator&&(a=new T("/shades/sw.js",{scope:"/shades/",type:"classic"}),a.addEventListener("activated",h=>{h.isUpdate?window.location.reload():n==null||n()}),a.register({immediate:t}).then(h=>{s==null||s(h)}).catch(h=>{c==null||c(h)})),d}class q{constructor(){f(this,"_best");this._best=parseInt(localStorage.getItem("best")||"0")}get best(){return this._best}set best(t){this._best=t,localStorage.setItem("best",this._best.toString())}}class A{constructor(){f(this,"root");f(this,"score");f(this,"best");f(this,"board");this.root=document.documentElement,this.score=document.getElementById("score"),this.best=document.getElementById("best-score"),this.board=document.getElementById("grid")}updateScore(t){this.score.onanimationend=()=>{this.score.classList.remove("animate"),this.root.style.setProperty("--old",`"${t}"`)},this.root.style.setProperty("--new",`"${t}"`),this.score.classList.add("animate")}updateBest(t){this.best.onanimationend=()=>{this.best.classList.remove("best-animate"),this.root.style.setProperty("--old-best",`"${t}"`)},this.root.style.setProperty("--new-best",`"${t}"`),this.best.classList.add("best-animate")}renderBoard(t){this.clear(),this.root.style.setProperty("--x",t.x.toString()),this.root.style.setProperty("--y",t.y.toString()),this.root.style.setProperty("--color",t.color.toCSS()),this.root.style.setProperty("--different",t.otherColor.toCSS());for(let e=0;e<t.numberOfSquares;e++){const n=document.createElement("div");n.classList.add("box"),e===t.chosen&&n.classList.add("different"),this.board.appendChild(n)}}getHandlerType(){return/iPad|iPhone|iPod/.test(navigator.userAgent)?"touchstart":"click"}clear(){var t;for(;(t=this.board)!=null&&t.firstChild;)this.board.removeChild(this.board.lastChild)}}const N=50,U=.97;class E{constructor(t,e,n){f(this,"l");f(this,"a");f(this,"b");this.l=t,this.a=e,this.b=n}toCSS(){let t=this.LabToXYZ(this),e=this.XYZToRGB(t);return`rgb(${e.r},${e.g},${e.b})`}LabToXYZ(t){let e=.008856451679035631,n=24389/27,s=(t.l+16)/116,c=t.a/500+s,a=s-t.b/200,d=c**3>e?c**3:(116*c-16)/n,h=t.l>n*e?Math.pow((t.l+16)/116,3):t.l/n,o=a**3>e?a**3:(116*a-16)/n;return{x:d*.95047,y:h,z:o*1.08883}}XYZToRGB(t){let e=t.x*1.7552599+t.y*-.4836786+t.z*-.253,n=t.x*-.5441336+t.y*1.5068789+t.z*.0215528,s=t.x*.0063467+t.y*-.0175761+t.z*1.2256959,c=[e,n,s];return c.forEach((a,d)=>{a>.0031308?a=1.055*Math.pow(a,1/2.4)-.055:a*=12.92,c[d]=Math.floor(a*255)}),{r:c[0],g:c[1],b:c[2]}}}class C{constructor(t){f(this,"color");f(this,"otherColor");[this.color,this.otherColor]=this.genColors(t)}genColors(t){const e=Math.ceil(N*Math.pow(U,t));let n=new E(Math.floor(Math.random()*25)+50,Math.floor(Math.random()*100)-50,Math.floor(Math.random()*100)-50),s=this.getOtherColor(n,e);return[n,s]}getOtherColor(t,e){let n=Math.random()<.5?-e:e;return Math.random()<.5?new E(t.l,t.a+n,t.b):new E(t.l,t.a,t.b+n)}}class V{constructor(){f(this,"_colors");f(this,"_numberOfSquares");f(this,"_chosen");f(this,"_dimensions");this._colors=new C(0),this._numberOfSquares=this.getNumberOfSquares(0),this._chosen=this.getChosen(this.numberOfSquares),this._dimensions=this.getBoardDimensions(this.numberOfSquares)}getBoardDimensions(t){let e=t,n=1;for(const s of[2,3,4])t%s===0&&t/s!==1&&(e=t/s,n=s);return[e,n]=[e,n].sort(),{x:e,y:n}}getChosen(t){return Math.floor(Math.random()*t)}getNumberOfSquares(t){if(t>=14)return 20;let e=t+3;for(;[7,11,13,14,17,18,19].includes(e);)e+=1;return e}generateBoard(t){this._colors=new C(t),this._numberOfSquares=this.getNumberOfSquares(t),this._chosen=this.getChosen(this.numberOfSquares),this._dimensions=this.getBoardDimensions(this.numberOfSquares)}get color(){return this._colors.color}get otherColor(){return this._colors.otherColor}get chosen(){return this._chosen}get numberOfSquares(){return this._numberOfSquares}get x(){return this._dimensions.x}get y(){return this._dimensions.y}}class ${constructor(){f(this,"_score");f(this,"_best");f(this,"gameView");f(this,"localStore");f(this,"board");this.localStore=new q,this._score=0,this._best=this.localStore.best,this.gameView=new A,this.board=new V}start(){this.gameView.updateScore(this.score),this.gameView.updateBest(this.best),this.gameView.renderBoard(this.board),this.addEventListeners()}addEventListeners(){var e;((e=document.getElementById("grid"))==null?void 0:e.childNodes).forEach(n=>n.addEventListener(this.gameView.getHandlerType(),s=>{s.preventDefault(),s.target.classList[1]?(this.score+=1,this.score>this.best&&(this.best+=1)):this.score=0},!1))}get best(){return this._best}set best(t){this._best=t,this.localStore.best=t,this.gameView.updateBest(this.best)}get score(){return this._score}set score(t){this._score=t,this.board.generateBoard(this.score),this.gameView.updateScore(this.score),this.gameView.renderBoard(this.board),this.addEventListeners()}}j();const G=new $;G.start();
