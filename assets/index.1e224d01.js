var t=Object.defineProperty,e=("undefined"!=typeof require&&require,(e,s,r)=>(((e,s,r)=>{s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r})(e,"symbol"!=typeof s?s+"":s,r),r));import{v as s}from"./vendor.23e2fa2d.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),"use-credentials"===t.crossorigin?e.credentials="include":"anonymous"===t.crossorigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class r{constructor(){e(this,"_best"),this._best=parseInt(localStorage.getItem("best")||"0")}get best(){return this._best}set best(t){this._best=t,localStorage.setItem("best",this._best.toString())}}class o{constructor(t){e(this,"root"),e(this,"score"),e(this,"best"),e(this,"board"),this.root=document.documentElement,this.score=document.getElementById("score"),this.best=document.getElementById("best-score"),this.board=document.getElementById("grid"),this.initializeAnimations(t)}initializeAnimations(t){this.best.onanimationend=()=>{this.best.classList.remove("best-animate"),this.root.style.setProperty("--old-best",`"${t.best}"`),t.oldBest=t.best},this.score.onanimationend=()=>{this.score.classList.remove("animate"),this.root.style.setProperty("--old",`"${t.score}"`)}}updateScore(t){this.root.style.setProperty("--new",`"${t.score}"`),this.score.classList.add("animate")}updateBest(t){this.root.style.setProperty("--new-best",`"${t.best}"`),this.best.classList.add("best-animate")}renderBoard(t){this.clear(),this.root.style.setProperty("--x",t.board.x.toString()),this.root.style.setProperty("--y",t.board.y.toString()),this.root.style.setProperty("--color",t.board.color.toCSS()),this.root.style.setProperty("--different",t.board.otherColor.toCSS());for(let e=0;e<t.board.numberOfSquares;e++){const s=document.createElement("div");s.classList.add("box"),s.addEventListener(this.getHandlerType(),(e=>{e.preventDefault();e.target.classList[1]?(t.score+=1,t.score>t.best&&(t.best+=1)):t.score=0}),!1),e===t.board.chosen&&s.classList.add("different"),this.board.appendChild(s)}}getHandlerType(){return/iPad|iPhone|iPod/.test(navigator.userAgent)?"touchstart":"click"}clear(){for(var t;null==(t=this.board)?void 0:t.firstChild;)this.board.removeChild(this.board.lastChild)}}class i{constructor(t,s,r){e(this,"h"),e(this,"s"),e(this,"l"),this.h=t,this.s=s,this.l=r}toCSS(){return`hsl(${this.h},${this.s}%,${this.l}%)`}}class n{constructor(t){e(this,"color"),e(this,"otherColor"),[this.color,this.otherColor]=this.genColors(t)}genColors(t){const e=Math.ceil(150*Math.pow(.97,t.score)),s=new i(Math.floor(360*Math.random()),100-Math.floor(Math.random()*(e/150)*50),Math.random()<.5?50-Math.floor(25*Math.random()/Math.sqrt(e)):50+Math.floor(25*Math.random()/Math.sqrt(e)));return[s,this.getOtherColor(s,e)]}getOtherColor(t,e){const s=Math.random()<.5?t.l+e/5:t.l-e/5;return new i(t.h,t.s,s)}}class a{constructor(t){e(this,"colors"),e(this,"_numberOfSquares"),e(this,"_chosen"),e(this,"dimensions"),[this.colors,this._numberOfSquares,this._chosen,this.dimensions]=this.generateBoard(t)}getBoardDimensions(t){let e=t,s=1;for(const r of[2,3,4])t%r==0&&t/r!=1&&(e=t/r,s=r);return[e,s]=[e,s].sort(),{x:e,y:s}}getChosen(t){return Math.floor(Math.random()*t)}getNumberOfSquares(t){if(t.score>=14)return 20;let e=t.score+3;for(;[7,11,13,14,17,18,19].includes(e);)e+=1;return e}generateBoard(t){return this.colors=new n(t),this._numberOfSquares=this.getNumberOfSquares(t),this._chosen=this.getChosen(this._numberOfSquares),this.dimensions=this.getBoardDimensions(this._numberOfSquares),[this.colors,this._numberOfSquares,this._chosen,this.dimensions]}get color(){return this.colors.color}get otherColor(){return this.colors.otherColor}get chosen(){return this._chosen}get numberOfSquares(){return this._numberOfSquares}get x(){return this.dimensions.x}get y(){return this.dimensions.y}}!function(t={}){const{immediate:e=!1,onNeedRefresh:r,onOfflineReady:o,onRegistered:i,onRegisterError:n}=t;let a;"serviceWorker"in navigator&&(a=new s("/sw.js",{scope:"/"}),a.addEventListener("activated",(t=>{t.isUpdate?window.location.reload():null==o||o()})),a.register({immediate:e}).then((t=>{null==i||i(t)})).catch((t=>{null==n||n(t)})))}();(new class{constructor(){e(this,"_score"),e(this,"_best"),e(this,"_oldBest"),e(this,"gameView"),e(this,"localStore"),e(this,"board"),this.localStore=new r,this._score=0,this._best=this.localStore.best,this._oldBest=this._best-1,this.gameView=new o(this),this.board=new a(this)}start(){this.board.generateBoard(this),this.gameView.updateScore(this),this.gameView.updateBest(this),this.gameView.renderBoard(this)}get best(){return this._best}set best(t){this._best=t,this.localStore.best=t,this.gameView.updateBest(this)}get score(){return this._score}set score(t){this._score=t,this.board.generateBoard(this),this.gameView.updateScore(this),this.gameView.renderBoard(this)}get oldBest(){return this._oldBest}set oldBest(t){this._oldBest=t}}).start();
