var m=Object.defineProperty;var f=(n,e,t)=>e in n?m(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var o=(n,e,t)=>(f(n,typeof e!="symbol"?e+"":e,t),t);import{v as g}from"./vendor.7c75cad7.js";const b=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}};b();function y(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:s,onRegisterError:i}=n;let a;const h=async(l=!0)=>{};return"serviceWorker"in navigator&&(a=new g("/shades/sw.js",{scope:"/shades/",type:"classic"}),a.addEventListener("activated",l=>{l.isUpdate?window.location.reload():r==null||r()}),a.register({immediate:e}).then(l=>{s==null||s(l)}).catch(l=>{i==null||i(l)})),h}class p{constructor(){o(this,"_best");this._best=parseInt(localStorage.getItem("best")||"0")}get best(){return this._best}set best(e){this._best=e,localStorage.setItem("best",this._best.toString())}}class S{constructor(){o(this,"root");o(this,"score");o(this,"best");o(this,"board");this.root=document.documentElement,this.score=document.getElementById("score"),this.best=document.getElementById("best-score"),this.board=document.getElementById("grid")}updateScore(e){this.score.onanimationend=()=>{this.score.classList.remove("animate"),this.root.style.setProperty("--old",`"${e}"`)},this.root.style.setProperty("--new",`"${e}"`),this.score.classList.add("animate")}updateBest(e){this.best.onanimationend=()=>{this.best.classList.remove("best-animate"),this.root.style.setProperty("--old-best",`"${e}"`)},this.root.style.setProperty("--new-best",`"${e}"`),this.best.classList.add("best-animate")}renderBoard(e){this.clear(),this.root.style.setProperty("--x",e.x.toString()),this.root.style.setProperty("--y",e.y.toString()),this.root.style.setProperty("--color",e.color.toCSS()),this.root.style.setProperty("--different",e.otherColor.toCSS());for(let t=0;t<e.numberOfSquares;t++){const r=document.createElement("div");r.classList.add("box"),t===e.chosen&&r.classList.add("different"),this.board.appendChild(r)}}getHandlerType(){return/iPad|iPhone|iPod/.test(navigator.userAgent)?"touchstart":"click"}clear(){var e;for(;(e=this.board)!=null&&e.firstChild;)this.board.removeChild(this.board.lastChild)}}const _=50,w=.97;class c{constructor(e,t,r){o(this,"l");o(this,"a");o(this,"b");this.l=e,this.a=t,this.b=r}toCSS(){let e=this.LabToXYZ(this),t=this.XYZToRGB(e);return`rgb(${t.r},${t.g},${t.b})`}LabToXYZ(e){let t=.008856451679035631,r=24389/27,s=(e.l+16)/116,i=e.a/500+s,a=s-e.b/200,h=i**3>t?i**3:(116*i-16)/r,l=e.l>r*t?Math.pow((e.l+16)/116,3):e.l/r,u=a**3>t?a**3:(116*a-16)/r;return{x:h*95.047,y:l*100,z:u*108.883}}XYZToRGB(e){let t=e.x*1.7552599+e.y*-.4836786+e.z*-.253,r=e.x*-.5441336+e.y*1.5068789+e.z*.0215528,s=e.x*.0063467+e.y*-.0175761+e.z*1.2256959;return{r:Math.floor(t),g:Math.floor(r),b:Math.floor(s)}}}class d{constructor(e){o(this,"color");o(this,"otherColor");[this.color,this.otherColor]=this.genColors(e)}genColors(e){const t=Math.ceil(_*Math.pow(w,e));console.log("colorOffset: "+t);let r,s;do r=new c(Math.floor(Math.random()*25)+75,Math.floor(Math.random()*100)-50,Math.floor(Math.random()*100)-50),s=this.getOtherColor(r,t);while(r.toCSS().includes("-")||s.toCSS().includes("-"));return[r,s]}getOtherColor(e,t){let r=Math.random()<.5?-t:t;return Math.random()<.5?new c(e.l,e.a+r,e.b):new c(e.l,e.a,e.b+r)}}class C{constructor(){o(this,"_colors");o(this,"_numberOfSquares");o(this,"_chosen");o(this,"_dimensions");this._colors=new d(0),this._numberOfSquares=this.getNumberOfSquares(0),this._chosen=this.getChosen(this.numberOfSquares),this._dimensions=this.getBoardDimensions(this.numberOfSquares)}getBoardDimensions(e){let t=e,r=1;for(const s of[2,3,4])e%s===0&&e/s!==1&&(t=e/s,r=s);return[t,r]=[t,r].sort(),{x:t,y:r}}getChosen(e){return Math.floor(Math.random()*e)}getNumberOfSquares(e){if(e>=14)return 20;let t=e+3;for(;[7,11,13,14,17,18,19].includes(t);)t+=1;return t}generateBoard(e){this._colors=new d(e),this._numberOfSquares=this.getNumberOfSquares(e),this._chosen=this.getChosen(this.numberOfSquares),this._dimensions=this.getBoardDimensions(this.numberOfSquares)}get color(){return this._colors.color}get otherColor(){return this._colors.otherColor}get chosen(){return this._chosen}get numberOfSquares(){return this._numberOfSquares}get x(){return this._dimensions.x}get y(){return this._dimensions.y}}class L{constructor(){o(this,"_score");o(this,"_best");o(this,"gameView");o(this,"localStore");o(this,"board");this.localStore=new p,this._score=0,this._best=this.localStore.best,this.gameView=new S,this.board=new C}start(){this.gameView.updateScore(this.score),this.gameView.updateBest(this.best),this.gameView.renderBoard(this.board),this.addEventListeners()}addEventListeners(){var t;((t=document.getElementById("grid"))==null?void 0:t.childNodes).forEach(r=>r.addEventListener(this.gameView.getHandlerType(),s=>{s.preventDefault(),s.target.classList[1]?(this.score+=1,this.score>this.best&&(this.best+=1)):this.score=0},!1))}get best(){return this._best}set best(e){this._best=e,this.localStore.best=e,this.gameView.updateBest(this.best)}get score(){return this._score}set score(e){this._score=e,this.board.generateBoard(this.score),this.gameView.updateScore(this.score),this.gameView.renderBoard(this.board),this.addEventListeners()}}y();const O=new L;O.start();
